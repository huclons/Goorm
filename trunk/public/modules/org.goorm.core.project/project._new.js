/**
 * Copyright Sung-tae Ryu. All rights reserved.
 * Code licensed under the GPL v2 License:
 * http://www.goorm.org/License
 **/org.goorm.core.project._new=function(){this.dialog=null,this.buttons=null,this.tabview=null},org.goorm.core.project._new.prototype={init:function(){var e=this,t=function(){if($("#input_project_type").attr("value")=="")return alert.show("error"),!1;if($("#inputProjectSource").attr("value")=="")return alert.show("error"),!1;if($("#input_project_detailed_type").attr("value")=="")return alert.show("error"),!1;if($("#input_project_author").attr("value")=="")return alert.show("error"),!1;if($("#input_project_name").attr("value")=="")return alert.show("error"),!1;if($("#input_project_about").attr("value")=="")return alert.show("error"),!1;if($("#check_project_new_import").is(":checked")){if($("#project_new_import_file").attr("value").substr($("#project_new_import_file").attr("value").length-3,3).toLowerCase()!="zip")return alert.show("error"),!1}else{if(!/^[\w-]*$/.test($("#input_project_author").attr("value")))return alert.show("error"),!1;if(!/^[\w-]*$/.test($("#input_project_name").attr("value")))return alert.show("error"),!1}if($("#new_projectUsingPlugin").val()=="yes"){var e={project_new_svn_url:$("#project_new_svn_url").attr("value"),project_new_svn_id:$("#project_new_svn_id").attr("value"),project_new_svn_pw:$("#project_new_svn_pw").attr("value"),project_new_svn_save_pw:$("#project_new_svn_save_pw").is(":checked")},t=$("#input_project_type").attr("value"),n=$("#input_project_detailed_type").attr("value"),r=$("#input_project_author").attr("value"),i=$("#input_project_name").attr("value");core.status.current_project_path=r+"_"+i,core.status.current_project_name=i,core.status.current_project_type=t,core.module.plugin_manager.new_project(i,r,t,n,r+"_"+i,e)}else{var s=$("#check_use_collaboration").attr("checked");if(s==undefined||s=="undefined")s="not checked";var e={project_type:$("#input_project_type").attr("value"),project_detailed_type:$("#input_project_detailed_type").attr("value"),project_author:$("#input_project_author").attr("value"),project_name:$("#input_project_name").attr("value"),project_about:$("#input_project_about").attr("value"),use_collaboration:s};$.get("project/new",e,function(t){if(t.err_code!=0)return alert.show("error"),!1;core.status.current_project_path=t.project_author+"_"+t.project_name,core.status.current_project_name=t.project_name,core.status.current_project_type=t.project_type,core.module.plugin_manager.new_project(e),$("#check_project_new_import").is(":checked")&&(core.module.loading_bar.start("Import processing..."),console.log(core.status.current_project_path),$("#project_new_location").val(core.status.current_project_path),$("#project_new_import_form").submit()),core.dialog.open_project.open(t.project_author+"_"+t.project_name,t.project_name,t.project_type)})}this.hide()},n=function(){this.hide()};this.buttons=[{text:"OK",handler:t,isDefault:!0},{text:"Cancel",handler:n}],this.dialog=new org.goorm.core.project._new.dialog,this.dialog.init({title:"New Project",path:"configs/dialogs/org.goorm.core.project/project._new.html",width:800,height:500,modal:!0,buttons:this.buttons,success:function(){e.add_project_item();var t={target:"#project_new_import_upload_output",success:function(e){core.module.layout.project_explorer.refresh(),core.module.layout.refresh_console(),core.dialog.project_property.refresh_toolbox(),core.module.loading_bar.stop()}},t={target:"#project_new_import_upload_output",success:function(t){e.dialog.panel.hide(),core.module.loading_bar.stop(),t.err_code==0?(notice.show(t.message),core.module.layout.project_explorer.refresh()):alert.show(t.message)}};$("#project_new_import_form").ajaxForm(t),$("#project_new_import_form").submit(function(){return!1}),$("#check_project_new_import").click(function(){$(this).is(":checked")?$("#project_new_import_div").show():$("#project_new_import_div").hide()})},kind:"new_project"}),this.dialog=this.dialog.dialog},show:function(){this.dialog.total_step=$("div[id='project_new']").find(".wizard_step").size(),$(".project_wizard_first_button").click(function(){$(".project_wizard_second_button").removeClass("selected_button"),$("#input_project_type").attr("value",""),$("#input_project_detailed_type").attr("value",""),$("#text_project_description").empty(),$(".project_wizard_first_button").removeClass("selected_button"),$(this).addClass("selected_button"),$(".all").hide(),$("."+$(this).attr("project-type")).show()}),$(".project_wizard_second_button").click(function(){$(".project_wizard_second_button").removeClass("selected_button"),$(this).addClass("selected_button"),$("#input_project_type").attr("value",""),$("#input_project_detailed_type").attr("value",""),$("#input_project_type").attr("value",$(this).attr("projecttype")),$("#input_project_detailed_type").attr("value",$(this).text()),$("#text_project_description").empty(),$("#text_project_description").append($(this).attr("description"));var e=this;$("#new_projectExpansionContainer").children().each(function(t){$(this).attr("expansion")==$(e).attr("expansion")?$(this).show():$(this).hide()})}),$(".project_wizard_second_button").removeClass("selected_button"),$(".project_wizard_second_button").removeClass("selected_button"),$("#input_project_type").attr("value",""),$("#input_project_detailed_type").val(""),$("#input_project_author").val(""),$("#input_project_name").val(""),$("#input_project_about").val(""),$("#project_new_import_upload_output").empty(),$("#project_new_import_file").val(""),$("#check_project_new_import").attr("checked",!1),$("#check_use_collaboration").attr("checked",!1),$("div[id='project_new']").find(".project_types").scrollTop(0),$("div[id='project_new']").find(".project_items").scrollTop(0),this.dialog.showFirstPage(),this.dialog.panel.show()},add_project_item:function(){$("div[id='project_new']").find(".project_types").append("<div class='project_wizard_first_button' project-type='all'><div class='project_type_icon'><img src='images/org.goorm.core.project/project.png' class='project_icon' /></div><div class='project_type_title'>All</div><div class='project_type_description'>View all available project items (including plugins)</div></div>"),$("div[id='project_new']").find(".project_types").append("<div class='project_wizard_first_button' project-type='goormp'><div class='project_type_icon'><img src='images/org.goorm.core.project/goorm_project.png' class='project_icon' /></div><div class='project_type_title'>goorm Project</div><div class='project_type_description'>goorm3 Project Customization/Plugin/Theme</div></div>"),$("div[id='project_new']").find(".project_items").append("<div class='project_wizard_second_button all goormp' description=' Create New goorm Customization Project' projecttype='goorm'><img src='images/org.goorm.core.project/customization.png' class='project_item_icon' /><br /><a>goorm Customization</a></div>"),$("div[id='project_new']").find(".project_items").append("<div class='project_wizard_second_button all goormp' description=' Create New goorm Plugin' projecttype='goorm'><img src='images/org.goorm.core.project/plugin.png' class='project_item_icon' /><br /><a>goorm Plugin</a></div>"),$("div[id='project_new']").find(".project_items").append("<div class='project_wizard_second_button all goormp' description=' Create New goorm Theme' projecttype='goorm'><img src='images/org.goorm.core.project/theme.png' class='project_item_icon' /><br /><a>goorm Theme</a></div>")}};