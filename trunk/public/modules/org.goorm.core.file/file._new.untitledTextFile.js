/**
 * Copyright Sung-tae Ryu. All rights reserved.
 * Code licensed under the GPL v2 License:
 * http://www.goorm.org/License
 * version: 3.0.0
 * This is the module example for YUI_DOCS
 * @module file
 **//**
 * This is an goorm code generator.  
 * goorm starts with this code generator.
 * @class _new
 * @extends file
 **/org.goorm.core.file._new.untitledTextFile=function(){this.dialog=null,this.buttons=null,this.treeView=null,this.currentPath=null},org.goorm.core.file._new.untitledTextFile.prototype={init:function(){var self=this,handleOk=function(){var postdata={currentProjectPath:$("#textNewinputLocationPath").val()};$.post("file/new",postdata,function(data){var receivedData=eval("("+data+")");core.mainLayout.workSpace.windowManager.open("../../project/"+$("#textNewinputLocationPath").val(),receivedData.filename,"txt"),core.mainLayout.projectExplorer.refresh()}),this.hide()},handleCancel=function(){this.hide()};this.buttons=[{text:"OK",handler:handleOk,isDefault:!0},{text:"Cancel",handler:handleCancel}],this.dialog=new org.goorm.core.file._new.untitledTextFile.dialog,this.dialog.init({title:"New Untitled Text File",path:"configs/dialogs/org.goorm.core.file/file._new.untitledTextFile.html",width:400,height:460,modal:!0,buttons:this.buttons,success:function(){}}),this.dialog=this.dialog.dialog},show:function(e){var t=this;this.currentPath="/"+core.currentProjectPath;if(e){var n=core.selectedFile;n=n.replace(/\.\.\/\.\.\/project\/\//,""),n=n.replace(/\.\.\/\.\.\/project\//,""),n="/"+n,n=n.replace(/\/\/\//,"/"),n=n.replace(/\/\//,"/"),$("#textNewinputLocationPath").val(n)}else $("#textNewinputLocationPath").val(this.currentPath);var r={kind:"project",projectName:this.currentPath,folderOnly:"true"};this.addDirectories(r),this.dialog.panel.show()},addDirectories:function(postdata){var self=this;$.post("file/get_nodes",postdata,function(data){var sortProjectTreeview=function(e){s.quickSort(e);for(i=0;i<e.length;i++)e[i].children&&s.quickSort(e[i].children)},sortingData=eval(data);sortProjectTreeview(sortingData);var newData=new Array;for(var name in sortingData)sortingData[name].cls=="folder"&&newData.push(sortingData[name]);self.treeView=new YAHOO.widget.TreeView("textNewTreeview",newData),self.treeView.subscribe("clickEvent",function(e){if(e.node.data.cls=="folder"){var t=e.node.data.filename,n=e.node.data.filetype,r=e.node.data.parentLabel,i=r+"/"+t;i=i.replace(/\.\.\/\.\.\/project\/\//,""),i=i.replace(/\.\.\/\.\.\/project\//,""),i="/"+i,i=i.replace(/\/\/\//,"/"),i=i.replace(/\/\//,"/"),self.currentPath=i,$("#textNewinputLocationPath").attr("value",self.currentPath)}return!1}),self.treeView.subscribe("dblClickEvent",function(e){e.node.data.cls=="folder"&&(e.node.expanded?e.node.collapse():e.node.expand())}),self.treeView.render(),self.treeExpandComplete(),self.treeView.subscribe("expandComplete",function(){self.treeExpandComplete()}),self.currentPath==""&&($("#textNewTreeview").find(".ygtvdepth0").find(".ygtvcell").prev().addClass("ygtvfocus"),$("#textNewTreeview").find(".ygtvdepth0").find(".ygtvcell").addClass("ygtvfocus"))})},expandDirectory:function(e){$("#folerNewTreeview").find(".ygtvfocus").parent().parent().parent().parent().find(".ygtvcell").each(function(){$(this).find(".fullpath").text().split("/").pop()==e&&($("#textNewTreeview").find(".ygtvfocus").removeClass("ygtvfocus"),$(this).prev().addClass("ygtvfocus"),$(this).addClass("ygtvfocus"))}),this.treeView.getNodeByElement($("#textNewTreeview").find(".ygtvfocus")[0]).expand()},treeExpandComplete:function(){$("#textNewTreeview").find(".ygtvcell").unbind("mousedown"),$("#textNewTreeview").find(".ygtvcell").mousedown(function(e){$(this).hasClass("ygtvfocus")==0&&($("#textNewTreeview").find(".ygtvfocus").removeClass("ygtvfocus"),$(this).hasClass("ygtvcontent")&&($(this).prev().addClass("ygtvfocus"),$(this).addClass("ygtvfocus")))})}};