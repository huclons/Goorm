/**
 * Copyright Sung-tae Ryu. All rights reserved.
 * Code licensed under the GPL v2 License:
 * http://www.goorm.org/License
 **/org.goorm.core.file.move=function(){this.dialog=null,this.buttons=null,this.dialog_explorer=null},org.goorm.core.file.move.prototype={init:function(){var e=this,t=function(){var t=e.dialog_explorer.get_data();if(t.path==""||t.name=="")return alert.show("File Name is Empty."),!1;var n={ori_path:$("#file_move_ori_path").val(),ori_file:$("#file_move_ori_file").val(),dst_path:t.path,dst_file:t.name};$.get("file/move",n,function(t){if(t.err_code==0){if(e.is_alive_window){var n=core.module.layout.workspace.window_manager,r=n.window[n.active_window].filetype;n.window[n.active_window].close(),n.open(t.path,t.file,r)}core.module.layout.project_explorer.refresh()}else alert.show(t.message)}),this.hide()},n=function(){this.hide()};this.buttons=[{text:"OK",handler:t,isDefault:!0},{text:"Cancel",handler:n}],this.dialog=new org.goorm.core.file.move.dialog,this.dialog.init({title:"Move file",path:"configs/dialogs/org.goorm.core.file/file.move.html",width:800,height:500,modal:!0,buttons:this.buttons,success:function(){var e=new YAHOO.util.Resize("move_dialog_left",{handles:["r"],minWidth:200,maxWidth:400});e.on("resize",function(e){var t=$("#move_dialog_middle").width(),n=e.width;$("#move_dialog_center").css("width",t-n-9+"px")}),$("#file_move_project_type").change(function(){var e=$(this).val();$("#move_dialog_center").find(".file_item").each(function(){e==0?$(this).css("display","block"):$(this).attr("filetype")==e?$(this).css("display","block"):$(this).css("display","none")})})}}),this.dialog=this.dialog.dialog,this.dialog_explorer=new org.goorm.core.dialog.explorer},show:function(e){var t=this;t.dialog_explorer.init("#file_move",!1);if(e){var n=core.status.selected_file.split("/").pop(),r=core.status.selected_file.replace(n,"");r=r.replace("//","/"),$("#file_move_ori_file").attr("value",n),$("#file_move_ori_path").attr("value",r),$("#file_move_target_name").attr("value",n);var i=core.module.layout.workspace.window_manager;for(var s=0;s<i.index;s++){var o=i.window[s].filename,u=i.window[s].filepath;u+="/",u=u.replace("//","/"),i.window[s].alive&&o==n&&u==r&&(t.is_alive_window=!0)}}else{var i=core.module.layout.workspace.window_manager;for(var s=0;s<i.index;s++)i.window[s].alive&&(t.is_alive_window=!0);if(t.is_alive_window)$("#file_move_ori_file").attr("value",i.window[i.active_window].filename),$("#file_move_ori_path").attr("value",i.window[i.active_window].filepath),$("#file_move_target_name").attr("value",i.window[i.active_window].filename);else{var a=core.status.selected_file,f=a.split("/").pop();a=a.replace(f,""),$("#file_move_ori_file").attr("value",f),$("#file_move_ori_path").attr("value",a),$("#file_move_target_name").attr("value",f)}}this.dialog.panel.show()}};