/**
 * Copyright Sung-tae Ryu. All rights reserved.
 * Code licensed under the GPL v2 License:
 * http://www.goorm.org/License
 **/org.goorm.core.toolbar=function(){this.context_menu=null,this.order=null,this.index=0,this.index_check=0},org.goorm.core.toolbar.prototype={init:function(){var e=this;this.order=localStorage["toolbar.order"],this.index=0,this.index_check=0,$(this).one("toolbarLoaded",e.set_draggable);if(this.order){this.order=this.order.split("|");for(var t=0;t<this.order.length;t++)this.add("public/configs/toolbars/"+this.order[t]+"/"+this.order[t].split(".").pop()+".toolbar.html",this.order[t],"goorm_main_toolbar")}else this.order=new Array("org.goorm.core.file","org.goorm.core.edit","org.goorm.core.project","org.goorm.core.window","org.goorm.core.design"),localStorage["toolbar.order"]=this.order.join("|"),this.add("public/configs/toolbars/org.goorm.core.file/file.toolbar.html","org.goorm.core.file","goorm_main_toolbar"),this.add("public/configs/toolbars/org.goorm.core.edit/edit.toolbar.html","org.goorm.core.edit","goorm_main_toolbar"),this.add("public/configs/toolbars/org.goorm.core.project/project.toolbar.html","org.goorm.core.project","goorm_main_toolbar"),this.add("public/configs/toolbars/org.goorm.core.window/window.toolbar.html","org.goorm.core.window","goorm_main_toolbar"),this.add("public/configs/toolbars/org.goorm.core.design/design.toolbar.html","org.goorm.core.design","goorm_main_toolbar")},set_draggable:function(){var e=this,t=new Array,n=new Array,r=YAHOO.util.Dom,i=YAHOO.util.Event,s=YAHOO.util.DragDropMgr;for(var o=0;o<e.order.length;o++){t[o]=new YAHOO.util.DD(e.order[o].split(".").pop()+".toolbar"),t[o].setHandleElId("toolbar_handle_"+e.order[o]);var u=this,a=null;t[o].on("startDragEvent",function(e){$(".toolbar_moving_handle").css("background","#eee"),u.dragEl=this.getDragEl()},t[o],!0),t[o].on("dragEnterEvent",function(e,t){a=r.get(e.info)},t[o],!0),t[o].on("dragOverEvent",function(e,t){Math.abs(r.getX(a)-r.getX(u.dragEl))<14?r.setStyle(r.getFirstChild(a),"background","#fcc"):r.setStyle(r.getFirstChild(a),"background","#eee")},t[o],!0),t[o].on("dragDropEvent",function(e,t){if(Math.abs(r.getX(a)-r.getX(u.dragEl))<14){a.parentNode.insertBefore(u.dragEl,a);var n="",i=0;$("#goorm_main_toolbar").children("div .toolbar_part").each(function(e){e!=0&&(n+="|"),n+=$(this).children("div").attr("id").split("_").pop()}),localStorage["toolbar.order"]=n}},t[o],!0),t[o].on("endDragEvent",function(e){$(".toolbar_moving_handle").css("background","none");var t=u.dragEl;r.setStyle(t.id,"left","0"),r.setStyle(t.id,"top","0")},t[o],!0),t[o].on("mouseUpEvent",function(e){$(".toolbar_moving_handle").css("background","none")},t[o],!0)}localStorage["preference.editor.use_clipboard"]=="true"&&$("a[action=use_clipboard]").find("img").addClass("toolbar_buttonPressed"),$(document).bind("on_preference_confirmed",function(){localStorage["preference.editor.use_clipboard"]=="true"?$("a[action=use_clipboard]").find("img").addClass("toolbar_buttonPressed"):$("a[action=use_clipboard]").find("img").removeClass("toolbar_buttonPressed")})},add:function(e,t,n){var r=this,i="file/get_contents",s=this.index++;$.ajax({url:i,type:"GET",data:"path="+e,async:!1,success:function(e){$("#"+n).append(e);var i=t.split(".").pop();$("div[id='"+i+".toolbar']").prepend("<div id='toolbar_handle_"+t+"' class='toolbar_moving_handle'><div class='toolbar_handle'></div></div>"),r.index_check++,r.index_check==r.order.length&&$(r).trigger("toolbarLoaded")}})},switch_state:function(e){switch(e){case"Rule_Editor":case"Editor":$("#design\\.toolbar").css("opacity","0.3").css("filter","alpha(opacity=30)").children().addClass("disabled"),$("#edit\\.toolbar").css("opacity","1.0").css("filter","alpha(opacity=100)").children().removeClass("disabled"),$("#goorm_mainmenu #Design").find("li").each(function(){$(this).addClass("yuimenuitem-disabled"),$(this).children("a").addClass("yuimenuitemlabel-disabled")});break;case"Designer":$("#design\\.toolbar").css("opacity","1.0").css("filter","alpha(opacity=100)").children().removeClass("disabled"),$("#goorm_mainmenu #Design").find("li").each(function(){$(this).removeClass("yuimenuitem-disabled"),$(this).children("a").removeClass("yuimenuitemlabel-disabled")});break;default:}},remove:function(){delete this}};