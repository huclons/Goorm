var fs=require("fs"),walk=require("walk"),emitter,common=require(__path+"plugins/org.goorm.plugin.java/modules/common.js");module.exports={do_new:function(e,t){var n=__path+"workspace/"+e.data.project_author+"_"+e.data.project_name,r=common.path+"template";emittor=walk.walk(r),emittor.on("file",function(t,i,s){var o=(t+"/"+i.name).replace(r,"");fs.readFile(t+"/"+i.name,"utf-8",function(t,r){if(t)throw t;r=r.replace("{PROJECTNAME}",e.data.project_name),fs.writeFile(n+o,r,function(e){if(e)throw e})}),s()}),emittor.on("directory",function(e,t,i){var s=(e+"/"+t.name).replace(r,"");fs.exists(n+s,function(e){e||fs.mkdirSync(n+s),i()}),i()}),emittor.on("end",function(){t.emit("do_new_complete",{code:200,message:"success"})})}};