/**
 * Copyright Sung-tae Ryu. All rights reserved.
 * Code licensed under the GPL v2 License:
 * http://www.goorm.org/License
 **/org.goorm.core.file.rename=function(){this.dialog=null,this.buttons=null,this.tabview=null,this.treeview=null,this.is_alive_window=null},org.goorm.core.file.rename.prototype={init:function(){var e=this,t=function(){var t=$("#input_rename_old_filepath").val(),n=$("#input_rename_old_filename").val(),r=$("#input_rename_new_filename").val();if(r=="")return alert.show("File name is empty"),!1;if(r.indexOf(" ")!=-1)return alert.show("Can not use space in file name"),!1;var i={ori_path:$("#input_rename_old_filepath").attr("value"),ori_name:$("#input_rename_old_filename").attr("value"),dst_name:$("#input_rename_new_filename").attr("value")};$.get("file/rename",i,function(t){var n=t;if(n.err_code==0){if(e.is_alive_window){var r=core.module.layout.workspace.window_manager,i=r.window[r.active_window].filetype;r.window[r.active_window].close(),r.open(n.path,n.file,i)}core.module.layout.project_explorer.refresh()}else alert.show(n.message)}),this.hide()},n=function(){this.hide()};this.buttons=[{text:"OK",handler:t,isDefault:!0},{text:"Cancel",handler:n}],this.dialog=new org.goorm.core.file.rename.dialog,this.dialog.init({title:"Rename",path:"configs/dialogs/org.goorm.core.file/file.rename.html",width:450,height:120,modal:!0,buttons:this.buttons,success:function(){}}),this.dialog=this.dialog.dialog},show:function(e){var t=this;t.is_alive_window=!1;if(e){var n=core.status.selected_file.split("/").pop(),r=core.status.selected_file.replace(n,"");r=r.replace("//","/"),$("#input_rename_new_filename").attr("value",n),$("#input_rename_old_filepath").attr("value",r),$("#input_rename_old_filename").attr("value",n);var i=core.module.layout.workspace.window_manager;for(var s=0;s<i.index;s++){var o=i.window[s].filename,u=i.window[s].filepath;u+="/",u=u.replace("//","/"),i.window[s].alive&&o==n&&u==r&&(t.is_alive_window=!0)}this.dialog.panel.show()}else{var i=core.module.layout.workspace.window_manager;for(var s=0;s<i.index;s++)i.window[s].alive&&(t.is_alive_window=!0);if(t.is_alive_window)$("#input_rename_new_filename").attr("value",i.window[i.active_window].filename),$("#input_rename_old_filepath").attr("value",i.window[i.active_window].filepath),$("#input_rename_old_filename").attr("value",i.window[i.active_window].filename);else{var a=core.status.selected_file,f=a.split("/").pop();a=a.replace(f,""),$("#input_rename_new_filename").attr("value",f),$("#input_rename_old_filepath").attr("value",a),$("#input_rename_old_filename").attr("value",f)}this.dialog.panel.show()}}};