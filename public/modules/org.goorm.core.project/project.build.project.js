/**
 * Copyright Sung-tae Ryu. All rights reserved.
 * Code licensed under the GPL v2 License:
 * http://www.goorm.org/License
 **/org.goorm.core.project.build.project=function(){this.dialog=null,this.buttons=null,this.button_select_all=null,this.button_deselect_all=null,this.is_repeat=null,this.is_onclick=!1},org.goorm.core.project.build.project.prototype={init:function(){var e=this;e.is_repeat=!1;var t=function(){$("#build_project_list input[type=checkbox]").each(function(){var n=this;if($(n).is(":checked")){var r=core.module.layout.workspace.window_manager,i=!1,s=-1,o="";e.is_repeat||$(r.window).each(function(e){$(n).attr("project_path")+"/"==this.filepath&&!this.isSaved&&(o=this.filename,i=!0,s=e)}),!i&&!e.is_repeat?(confirmation_save.init({title:core.module.localization.msg.confirmationSaveTitle2.value,message:'"'+o+'" '+core.module.localization.msg.confirmationSaveMessage2.value,yes_text:core.module.localization.msg.confirmationYes.value,cancel_text:core.module.localization.msg.confirmationCancel.value,no_text:core.module.localization.msg.confirmationNo.value,yes:function(){e.is_repeat=!0,r.window[s].editor.save(),t(),e.dialog.panel.hide()},cancel:function(){return e.is_repeat=!1,!1},no:function(){e.is_repeat=!0,t(),e.dialog.panel.hide()}}),confirmation_save.panel.show()):(e.is_repeat&&confirmation_save.panel.hide(),e.is_repeat=!1,e.is_onclick?e.is_onclick=!1:$.isEmptyObject(core.module.plugin_manager.plugins["org.goorm.plugin."+$(n).attr("projectType")])?alert.show("Cannot find plugin to build project!"):(core.module.plugin_manager.plugins["org.goorm.plugin."+$(n).attr("projectType")].build($(n).attr("project_name"),$(n).attr("project_path")),e.is_onclick=!0,e.dialog.panel.hide()))}}),this.hide()},n=function(){this.hide()};this.buttons=[{text:"Build",handler:t,isDefault:!0},{text:"Cancel",handler:n}],this.dialog=new org.goorm.core.project.build.project.dialog,this.dialog.init({title:"Build Project",path:"configs/dialogs/org.goorm.core.project/project.build.project.html",width:400,height:400,modal:!0,buttons:this.buttons,success:function(){e.button_select_all=new YAHOO.widget.Button("build_project_select_all"),e.button_deselect_all=new YAHOO.widget.Button("build_project_deselect_all"),$("#build_project_select_all").click(function(){e.select_all()}),$("#build_project_deselect_all").click(function(){e.deselect_all()})}}),this.dialog=this.dialog.dialog},show:function(){var e=this;this.project_list(),e.is_onclick=!1,this.dialog.panel.show()},select_all:function(){$("#build_project_list input[type=checkbox]").attr("checked",!0)},deselect_all:function(){$("#build_project_list input[type=checkbox]").attr("checked",!1)},project_list:function(){$("#build_project_list").empty(),$.get("project/get_list","",function(data){var list=eval(data);$.each(list,function(e,t){if(!$.isEmptyObject(core.module.plugin_manager.plugins["org.goorm.plugin."+t.contents.type])&&core.module.plugin_manager.plugins["org.goorm.plugin."+t.contents.type].build){var n="";n+="<div id='selector_"+t.name+"' value='"+t.name+"' class='select_div' style='height:14px;'>",n+="<div style='float:left;'>",n+="<input type='checkbox' name='"+t.name+"' project_path='"+t.name+"' project_name='"+t.contents.name+"' projectType='"+t.contents.type+"'",t.name==core.status.current_project_path&&(n+="checked"),n+="></div> ",n+="<div style='float:left; padding-top:1px; padding-left:5px;'>"+t.name+"</div>",n+="</div>",$("#build_project_list").append(n),$("#selector_"+t.name).click(function(){$(this).find("input").attr("checked",!$(this).find("input").attr("checked"))})}})})}};